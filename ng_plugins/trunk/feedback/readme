# =========================================================================== #
# NG CMS // Плагины // Генератор форм обратной связи                          #
# =========================================================================== #

 Плагин feedback позволяет администратору создавать различные типы форм
обратной связи, которые будет заполнять посетитель.

Плагином поддерживается неограниченное кол-во форм, внутри формы может быть
любое кол-во полей.
Поле может быть следующего типа:
1. Текстовое - одна строка, которую вводит пользователь
2. Текстовый блок - многострочный блок (textarea)
3. Поле выбора - выпадающий список, варианты со значениями прописываются
   администратором при создании/настройке формы обратной связи

Результаты заполнения форм отправляются на заранее заданный список e-mail
адресов (список задаётся для каждой формы отдельно)

Настройка плагина
=====================

[x] Создание формы.
------------------------
При нажатии на ссылку "создать новую форму" создаётся пустая форма с 
id "newform". При использовании настоятельно рекомендуется заменить
идентификатор формы на другое.

[x] Использование формы.
------------------------
Для того, чтобы форму можно было использовать, необходимо выставить 
флаг "активна" при её редактировании.


[x] Собственные шаблоны.
------------------------
При желании, вы можете создать свой собственный шаблон для любой
формы обратной связи.
Шаблоны хранятся в каталоге
engine/plugins/feedback/tpl/templates/

При указании собственного шаблона плагин вместо генерации оформления из
шаблона по умолчанию, просто выводит выбранный вами шаблон.

При создании собственных шаблонов следует:
1. Не забывать использовать переменные:
   {form_url}    - URL формы, на которую будет отправляться запрос;
                   тип запроса должен быть 'post'
   {id}          - значение переменной id формы
   {description} - описание формы обратной связи
   {entries}     - даже при использовании персонального шаблона плагин
                   самостоятельно генерирует набор полей шаблона. 
                   При желании Вы можете использовать эту переменную для
                   отображения набора полей, созданных плагином
2. Не забывать создавать ОБЯЗАТЕЛЬНЫЕ переменные для формы (type=hidden):
   id - значение берётся из переменной {id}
   plugin_cmd - значение 'post'
3. Помнить, что в собственных формах не работает автоматическая генерация
   вариантов для полей выбора (select)
4. Не забывать, что имена (name=) создаваемых вами полей обязаны совпадать
   с "ID поля" в описании структуры формы обратной связи
5. При включении CAPTCHA и возможности отправлять разным группам пользователей
   вам может потребоваться добавить переменные:
   {captcha} - форма для ввода кода проверки [ берётся из шаблона site.form.captcha.tpl ]
   {elist}   - список получателей сообщения
   {captcha_url} - URL картинки с captcha
   {captcha_rand} - случайное число для картинки с captcha, используется для предотвращения
   кеширования картинки с captcha.
   Пример: <img src="{captcha_url}&rand={rand}"/>


[x] Шаблоны плагина, используемые при отображении формы
--------------------------------------------------------
Файл      : site.infoblock.tpl 
Описание  : Отвечает за отображение общего информационного блока
            плагина
Переменные: {tpl_url}  - URL текущего шаблона сайта
            {ptpl_url} - URL каталога плагина с шаблонами (tpl/)
            {title}    - название формы обратной связи
            {entries}  - содержимое формы обратной связи

Файл      : site.form.hdr.tpl
Описание  : Отвечает за генерацию формы обратной связи (кроме строк)
Переменные: {description} - описание формы
            {ptpl_url} - URL каталога плагина с шаблонами (tpl/)
            {form_url}    - URL формы, на которую будет отправляться запрос
            {id}          - значение переменной id формы

Файл      : site.form.row.tpl
Описание  : Отвечает за генерацию строки формы обратной связи
Переменные: {ptpl_url} - URL каталога плагина с шаблонами (tpl/)
            [text]     .. [/text]     - отображать блок для переменной типа "текстовая"
            [textarea] .. [/textarea] - отображать блок для переменной типа "текстовый блок"
            [select]   .. [/select]   - отображать блок для переменной типа "поле выбора"
            [date]     .. [/date]     - отображать блок для переменной типа "дата"
            {name}    - поле name для HTML переменной (input, textarea, select)
            {value}   - значение по умолчанию переменной
            {options} - набор значений (option,...) для переменной типа "поле выбора" (select)

Файл      : site.form.captcha.tpl
Описание  : Отвечает за генерацию строки формы обратной связи, содержащей проверочный код (CAPTCHA)
Переменные: {captcha_url} - URL к изображению captcha

Файл      : site.form.elist.tpl
Описание  : Отвечает за генерацию строки формы обратной связи, содержащей поле выбора получателей email'ов
Переменные: {options} - список названий возможных получателей


[x] Шаблоны плагина, используемые при отправке Email сообщения в HTML формате
--------------------------------------------------------
Файл      : htmail.tpl
Описание  : Отвечает за отображение Email письма
Переменные: {form.id}		- ID формы
            {form.title} 	- Название формы
            {form.description}	- Описание формы
            {entries}		- Поля формы, заполненные пользователем (посетителем)

Файл      : htmail.body.tpl
Описание  : Отвечает за отображение полей формы, заполненных пользователем (посетителем)
Переменные: {id}		- ID поля
            {title} 		- Наименование поля
            {value}		- Заполненное пользователем значение



Использование плагина
=====================
При заходе в режим редактирования формы обратной связи вы увидите URL, по которому данная форма будет доступна.
